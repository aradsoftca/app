{"version":3,"file":"static/js/659.80074322.chunk.js","mappings":"8IAOA,MAQA,EAR0BA,KACxBC,EAAAA,EAAAA,WAAU,KACR,MAAMC,EAAOC,SAASH,MAEtB,OADAG,SAASH,MAAQA,EAAK,GAAAI,OAAMJ,EAAK,aAAc,8BACxC,KAAQG,SAASH,MAAQE,IAC/B,CAACF,I,yICJN,MAmFA,EAnFuBK,MACrBC,EAAAA,EAAAA,GAAiB,WACjB,MAAMC,GAAWC,EAAAA,EAAAA,OACTC,MAAOC,IAAcC,EAAAA,EAAAA,MACtBC,IAAgBC,EAAAA,EAAAA,OAChBC,EAAOC,IAAYC,EAAAA,EAAAA,UAAS,IA6CnC,OA3CAf,EAAAA,EAAAA,WAAU,KACqBgB,WAC3B,MAAMC,EAAON,EAAaO,IAAI,QAG9B,GAFcP,EAAaO,IAAI,SAK7B,OAFAJ,EAAS,wDACTK,WAAW,IAAMb,EAAS,UAAW,KAIvC,IAAKW,EAGH,OAFAH,EAAS,wCACTK,WAAW,IAAMb,EAAS,UAAW,KAIvC,IAEE,MAAM,KAAEc,SAAeC,EAAAA,GAAWC,eAAeL,GAEjD,IAAIG,EAAKG,YAUP,MAAM,IAAIC,MAAM,4BAVI,EAGpBC,EAAAA,EAAAA,IAAeL,EAAKG,aACpBG,aAAaC,QAAQ,OAAQC,KAAKC,UAAUT,EAAKU,OAGjD,MAAMC,EAA0B,UAAnBX,EAAKU,KAAKE,KAAmB,SAAW,aACrDC,OAAOC,SAASC,KAAOJ,CACzB,CAGF,CAAE,MAAOK,GACPC,QAAQxB,MAAM,sBAAuBuB,GACrCtB,EAAS,4CACTK,WAAW,IAAMb,EAAS,UAAW,IACvC,GAGFgC,IACC,CAAC3B,EAAcL,KAGhBiC,EAAAA,EAAAA,KAAA,OAAKC,UAAU,6GAA4GC,UACzHF,EAAAA,EAAAA,KAACG,EAAAA,EAAOC,IAAG,CACTH,UAAU,cACVI,QAAS,CAAEC,QAAS,EAAGC,MAAO,IAC9BC,QAAS,CAAEF,QAAS,EAAGC,MAAO,GAC9BE,WAAY,CAAEC,SAAU,IAAMR,SAE7B5B,GACCqC,EAAAA,EAAAA,MAAA,OAAKV,UAAU,2EAA0EC,SAAA,EACvFF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,gBAAeC,SAAC,YAC/BF,EAAAA,EAAAA,KAAA,MAAIC,UAAU,0BAAyBC,SAAC,2BACxCF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,gBAAeC,SAAE5B,KAC9B0B,EAAAA,EAAAA,KAAA,KAAGC,UAAU,6BAA4BC,SAAC,gCAG5CS,EAAAA,EAAAA,MAAA,OAAKV,UAAU,oEAAmEC,SAAA,EAChFF,EAAAA,EAAAA,KAACG,EAAAA,EAAOC,IAAG,CACTI,QAAS,CAAEI,OAAQ,KACnBH,WAAY,CAAEC,SAAU,EAAGG,OAAQC,IAAUC,KAAM,UACnDd,UAAU,oBAAmBC,UAE7BF,EAAAA,EAAAA,KAACgB,EAAAA,GAAS,CAACf,UAAU,8BAEvBD,EAAAA,EAAAA,KAAA,MAAIC,UAAU,0BAAyBC,SAAC,2BACxCF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,gBAAeC,SAAC,0D","sources":["hooks/useDocumentTitle.js","pages/GoogleCallback.js"],"sourcesContent":["import { useEffect } from 'react';\r\n\r\n/**\r\n * Sets the document title for the current page.\r\n * Resets to default title on unmount.\r\n * @param {string} title - Page-specific title\r\n */\r\nconst useDocumentTitle = (title) => {\r\n  useEffect(() => {\r\n    const prev = document.title;\r\n    document.title = title ? `${title} | VPN XO` : 'VPN XO - Secure VPN Service';\r\n    return () => { document.title = prev; };\r\n  }, [title]);\r\n};\r\n\r\nexport default useDocumentTitle;\r\n","import React, { useEffect, useState } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport { FaSpinner } from 'react-icons/fa';\nimport { apiService, setAccessToken } from '../services/api';\nimport { useAuth } from '../hooks/useAuth';\nimport useDocumentTitle from '../hooks/useDocumentTitle';\n\nconst GoogleCallback = () => {\n  useDocumentTitle('Sign In');\n  const navigate = useNavigate();\n  const { login: authLogin } = useAuth();\n  const [searchParams] = useSearchParams();\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    const handleGoogleCallback = async () => {\n      const code = searchParams.get('code');\n      const error = searchParams.get('error');\n\n      if (error) {\n        setError('Google authentication failed. Please try again.');\n        setTimeout(() => navigate('/login'), 3000);\n        return;\n      }\n\n      if (!code) {\n        setError('No authorization code received.');\n        setTimeout(() => navigate('/login'), 3000);\n        return;\n      }\n\n      try {\n        // Send the authorization code to backend via apiService\n        const { data } = await apiService.googleCallback(code);\n\n        if (data.accessToken) {\n          // SEC-TOKEN-01: Store access token in memory only (never localStorage).\n          // Server already set the HttpOnly refreshToken cookie on this request.\n          setAccessToken(data.accessToken);\n          localStorage.setItem('user', JSON.stringify(data.user));\n\n          // Full page navigation — AuthContext init will restore session from cookie on reload.\n          const dest = data.user.tier === 'admin' ? '/admin' : '/dashboard';\n          window.location.href = dest;\n        } else {\n          throw new Error('No access token received');\n        }\n      } catch (err) {\n        console.error('Google OAuth error:', err);\n        setError('Authentication failed. Please try again.');\n        setTimeout(() => navigate('/login'), 3000);\n      }\n    };\n\n    handleGoogleCallback();\n  }, [searchParams, navigate]);\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 flex items-center justify-center\">\n      <motion.div\n        className=\"text-center\"\n        initial={{ opacity: 0, scale: 0.9 }}\n        animate={{ opacity: 1, scale: 1 }}\n        transition={{ duration: 0.5 }}\n      >\n        {error ? (\n          <div className=\"bg-red-500 bg-opacity-20 border border-red-500 rounded-lg p-6 text-white\">\n            <div className=\"text-6xl mb-4\">❌</div>\n            <h2 className=\"text-2xl font-bold mb-2\">Authentication Failed</h2>\n            <p className=\"text-gray-200\">{error}</p>\n            <p className=\"text-sm text-gray-300 mt-4\">Redirecting to login...</p>\n          </div>\n        ) : (\n          <div className=\"bg-white bg-opacity-10 backdrop-blur-md rounded-lg p-8 text-white\">\n            <motion.div\n              animate={{ rotate: 360 }}\n              transition={{ duration: 1, repeat: Infinity, ease: \"linear\" }}\n              className=\"inline-block mb-4\"\n            >\n              <FaSpinner className=\"text-6xl text-blue-400\" />\n            </motion.div>\n            <h2 className=\"text-2xl font-bold mb-2\">Completing Sign In...</h2>\n            <p className=\"text-gray-300\">Please wait while we authenticate your account</p>\n          </div>\n        )}\n      </motion.div>\n    </div>\n  );\n};\n\nexport default GoogleCallback;\n"],"names":["title","useEffect","prev","document","concat","GoogleCallback","useDocumentTitle","navigate","useNavigate","login","authLogin","useAuth","searchParams","useSearchParams","error","setError","useState","async","code","get","setTimeout","data","apiService","googleCallback","accessToken","Error","setAccessToken","localStorage","setItem","JSON","stringify","user","dest","tier","window","location","href","err","console","handleGoogleCallback","_jsx","className","children","motion","div","initial","opacity","scale","animate","transition","duration","_jsxs","rotate","repeat","Infinity","ease","FaSpinner"],"sourceRoot":""}