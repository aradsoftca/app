{"version":3,"file":"static/js/194.93b5e4de.chunk.js","mappings":"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","sources":["components/admin/RevenueForecasting.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { FaSync, FaChartLine, FaArrowUp, FaArrowDown } from 'react-icons/fa';\r\nimport Card from '../common/Card';\r\nimport Button from '../common/Button';\r\nimport { apiService } from '../../services/api';\r\n\r\nconst RevenueForecasting = () => {\r\n  const [predictions, setPredictions] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    loadPredictions();\r\n  }, []);\r\n\r\n  const loadPredictions = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const res = await apiService.getRevenuePredictions();\r\n      setPredictions(res.data);\r\n    } catch (err) {\r\n      console.error('Failed to load predictions:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-12\">\r\n        <div className=\"spinner\"></div>\r\n        <span className=\"ml-3 text-white\">Loading forecasts...</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const churn = predictions?.churn || predictions?.churn_prediction || {};\r\n  const revenue = predictions?.revenue || predictions?.revenue_forecast || {};\r\n  const predictedUsers = predictions?.predicted_churn_users || [];\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card className=\"p-6\">\r\n        <div className=\"flex justify-between items-center mb-6\">\r\n          <h2 className=\"text-2xl font-bold text-white flex items-center\">\r\n            <FaChartLine className=\"mr-3 text-yellow-400\" />\r\n            Revenue Forecasting & Churn Prediction\r\n          </h2>\r\n          <Button variant=\"outline\" size=\"sm\" icon={<FaSync />} onClick={loadPredictions}>\r\n            Refresh\r\n          </Button>\r\n        </div>\r\n\r\n        {!predictions ? (\r\n          <p className=\"text-gray-400 text-center py-8\">No forecast data available</p>\r\n        ) : (\r\n          <>\r\n            {/* Revenue Metrics */}\r\n            <div className=\"grid md:grid-cols-4 gap-6 mb-8\">\r\n              <Card className=\"p-5 bg-gradient-to-br from-green-600/20 to-green-800/20 border border-green-500/20\">\r\n                <p className=\"text-green-200 text-sm mb-1\">Current MRR</p>\r\n                <p className=\"text-white text-2xl font-bold\">\r\n                  ${(revenue.current_mrr || revenue.mrr || 0).toLocaleString()}\r\n                </p>\r\n              </Card>\r\n              <Card className=\"p-5 bg-gradient-to-br from-blue-600/20 to-blue-800/20 border border-blue-500/20\">\r\n                <p className=\"text-blue-200 text-sm mb-1\">Predicted Next Month</p>\r\n                <p className=\"text-white text-2xl font-bold\">\r\n                  ${(revenue.predicted_next_month || revenue.forecast_30d || 0).toLocaleString()}\r\n                </p>\r\n              </Card>\r\n              <Card className=\"p-5 bg-gradient-to-br from-yellow-600/20 to-yellow-800/20 border border-yellow-500/20\">\r\n                <p className=\"text-yellow-200 text-sm mb-1\">Growth Rate</p>\r\n                <p className=\"text-white text-2xl font-bold flex items-center gap-2\">\r\n                  {(revenue.growth_rate || 0) >= 0 ? (\r\n                    <FaArrowUp className=\"text-green-400\" />\r\n                  ) : (\r\n                    <FaArrowDown className=\"text-red-400\" />\r\n                  )}\r\n                  {Math.abs(revenue.growth_rate || 0).toFixed(1)}%\r\n                </p>\r\n              </Card>\r\n              <Card className=\"p-5 bg-gradient-to-br from-red-600/20 to-red-800/20 border border-red-500/20\">\r\n                <p className=\"text-red-200 text-sm mb-1\">Churn Risk</p>\r\n                <p className=\"text-white text-2xl font-bold\">\r\n                  {churn.at_risk_count || churn.high_risk || 0} users\r\n                </p>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Churn Details */}\r\n            <h3 className=\"text-lg font-bold text-white mb-4\">Churn Risk Overview</h3>\r\n            <div className=\"grid md:grid-cols-3 gap-6 mb-8\">\r\n              <div className=\"p-4 bg-gray-700/30 rounded-lg\">\r\n                <p className=\"text-gray-400 text-sm\">Predicted Churn Rate</p>\r\n                <p className=\"text-white text-xl font-bold\">{(churn.churn_rate || 0).toFixed(1)}%</p>\r\n              </div>\r\n              <div className=\"p-4 bg-gray-700/30 rounded-lg\">\r\n                <p className=\"text-gray-400 text-sm\">Revenue at Risk</p>\r\n                <p className=\"text-white text-xl font-bold\">${(churn.revenue_at_risk || 0).toLocaleString()}</p>\r\n              </div>\r\n              <div className=\"p-4 bg-gray-700/30 rounded-lg\">\r\n                <p className=\"text-gray-400 text-sm\">Avg Lifetime Value</p>\r\n                <p className=\"text-white text-xl font-bold\">${(revenue.avg_ltv || revenue.ltv || 0).toFixed(2)}</p>\r\n              </div>\r\n            </div>\r\n\r\n            {/* At-Risk Users */}\r\n            {predictedUsers.length > 0 && (\r\n              <>\r\n                <h3 className=\"text-lg font-bold text-white mb-4\">Users at Risk of Churning</h3>\r\n                <div className=\"overflow-x-auto\">\r\n                  <table className=\"w-full text-sm\">\r\n                    <thead>\r\n                      <tr className=\"border-b border-gray-600 text-gray-400\">\r\n                        <th className=\"text-left py-3 px-2\">User</th>\r\n                        <th className=\"text-left py-3 px-2\">Risk Score</th>\r\n                        <th className=\"text-left py-3 px-2\">Days Since Active</th>\r\n                        <th className=\"text-left py-3 px-2\">Plan Expires</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {predictedUsers.slice(0, 20).map((u, i) => (\r\n                        <tr key={u.id || i} className=\"border-b border-gray-700\">\r\n                          <td className=\"py-3 px-2 text-white\">{u.email || u.user_id || '—'}</td>\r\n                          <td className=\"py-3 px-2\">\r\n                            <span className={`px-2 py-1 rounded text-xs font-bold ${\r\n                              (u.risk_score || 0) > 70 ? 'bg-red-500/20 text-red-300' :\r\n                              (u.risk_score || 0) > 40 ? 'bg-yellow-500/20 text-yellow-300' :\r\n                              'bg-green-500/20 text-green-300'\r\n                            }`}>\r\n                              {u.risk_score || 0}%\r\n                            </span>\r\n                          </td>\r\n                          <td className=\"py-3 px-2 text-gray-300\">{u.days_inactive || '—'}</td>\r\n                          <td className=\"py-3 px-2 text-gray-400 text-xs\">\r\n                            {u.subscription_end_date ? new Date(u.subscription_end_date).toLocaleDateString() : '—'}\r\n                          </td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </>\r\n            )}\r\n          </>\r\n        )}\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RevenueForecasting;\r\n"],"names":["RevenueForecasting","predictions","setPredictions","useState","loading","setLoading","useEffect","loadPredictions","async","res","apiService","getRevenuePredictions","data","err","console","error","_jsxs","className","children","_jsx","churn","churn_prediction","revenue","revenue_forecast","predictedUsers","predicted_churn_users","Card","FaChartLine","Button","variant","size","icon","FaSync","onClick","_Fragment","current_mrr","mrr","toLocaleString","predicted_next_month","forecast_30d","growth_rate","FaArrowUp","FaArrowDown","Math","abs","toFixed","at_risk_count","high_risk","churn_rate","revenue_at_risk","avg_ltv","ltv","length","slice","map","u","i","email","user_id","concat","risk_score","days_inactive","subscription_end_date","Date","toLocaleDateString","id"],"sourceRoot":""}